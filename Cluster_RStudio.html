<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Kenedith. M. Méndez Gutiérrez">
<meta name="dcterms.date" content="2024-10-23">

<title>Análisis de clúster con RStudio</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Cluster_RStudio_files/libs/clipboard/clipboard.min.js"></script>
<script src="Cluster_RStudio_files/libs/quarto-html/quarto.js"></script>
<script src="Cluster_RStudio_files/libs/quarto-html/popper.min.js"></script>
<script src="Cluster_RStudio_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Cluster_RStudio_files/libs/quarto-html/anchor.min.js"></script>
<link href="Cluster_RStudio_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Cluster_RStudio_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Cluster_RStudio_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Cluster_RStudio_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Cluster_RStudio_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

<script src="Cluster_RStudio_files/libs/kePrint-0.0.1/kePrint.js"></script>
<link href="Cluster_RStudio_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Tabla de contenido</h2>
   
  <ul>
  <li><a href="#introducción" id="toc-introducción" class="nav-link active" data-scroll-target="#introducción"><span class="header-section-number">1</span> Introducción</a>
  <ul class="collapse">
  <li><a href="#qué-es" id="toc-qué-es" class="nav-link" data-scroll-target="#qué-es"><span class="header-section-number">1.0.1</span> ¿Qué es?</a></li>
  <li><a href="#objetivos-del-análisis" id="toc-objetivos-del-análisis" class="nav-link" data-scroll-target="#objetivos-del-análisis"><span class="header-section-number">1.0.2</span> Objetivos del análisis</a></li>
  <li><a href="#consideraciones-para-aplicar-el-análisis-a-una-matriz-de-datos-básica." id="toc-consideraciones-para-aplicar-el-análisis-a-una-matriz-de-datos-básica." class="nav-link" data-scroll-target="#consideraciones-para-aplicar-el-análisis-a-una-matriz-de-datos-básica."><span class="header-section-number">1.0.3</span> Consideraciones para aplicar el análisis a una matriz de datos básica.</a></li>
  </ul></li>
  <li><a href="#materiales." id="toc-materiales." class="nav-link" data-scroll-target="#materiales."><span class="header-section-number">2</span> Materiales.</a></li>
  <li><a href="#cómo-abordar-el-análisis" id="toc-cómo-abordar-el-análisis" class="nav-link" data-scroll-target="#cómo-abordar-el-análisis"><span class="header-section-number">3</span> ¿Cómo abordar el análisis?</a></li>
  <li><a href="#pasos-previos." id="toc-pasos-previos." class="nav-link" data-scroll-target="#pasos-previos."><span class="header-section-number">4</span> Pasos previos.</a>
  <ul class="collapse">
  <li><a href="#cargue-las-líbrerías." id="toc-cargue-las-líbrerías." class="nav-link" data-scroll-target="#cargue-las-líbrerías."><span class="header-section-number">4.1</span> 1. Cargue las líbrerías.</a></li>
  <li><a href="#importe-los-datos." id="toc-importe-los-datos." class="nav-link" data-scroll-target="#importe-los-datos."><span class="header-section-number">4.2</span> 2. Importe los datos.</a></li>
  <li><a href="#paso-1.-verifica-los-requerimientos." id="toc-paso-1.-verifica-los-requerimientos." class="nav-link" data-scroll-target="#paso-1.-verifica-los-requerimientos."><span class="header-section-number">4.3</span> Paso 1. Verifica los requerimientos.</a>
  <ul class="collapse">
  <li><a href="#verificar-si-el-conjunto-de-datos-no-se-encuentra-correlacionado." id="toc-verificar-si-el-conjunto-de-datos-no-se-encuentra-correlacionado." class="nav-link" data-scroll-target="#verificar-si-el-conjunto-de-datos-no-se-encuentra-correlacionado."><span class="header-section-number">4.3.1</span> Verificar si el conjunto de datos no se encuentra correlacionado.</a></li>
  <li><a href="#escoger-de-una-medida-de-distancia-propiada." id="toc-escoger-de-una-medida-de-distancia-propiada." class="nav-link" data-scroll-target="#escoger-de-una-medida-de-distancia-propiada."><span class="header-section-number">4.3.2</span> Escoger de una medida de distancia propiada.</a></li>
  <li><a href="#verificar-la-tendencia-de-agrupamiento-del-conjunto." id="toc-verificar-la-tendencia-de-agrupamiento-del-conjunto." class="nav-link" data-scroll-target="#verificar-la-tendencia-de-agrupamiento-del-conjunto."><span class="header-section-number">4.3.3</span> Verificar la tendencia de agrupamiento del conjunto.</a></li>
  </ul></li>
  <li><a href="#paso-2.-defina-el-tipo-de-algoritmo." id="toc-paso-2.-defina-el-tipo-de-algoritmo." class="nav-link" data-scroll-target="#paso-2.-defina-el-tipo-de-algoritmo."><span class="header-section-number">4.4</span> Paso 2. Defina el tipo de algoritmo.</a>
  <ul class="collapse">
  <li><a href="#paso-2.1.-defina-el-método-de-agrupación-en-caso-de-cluster-jerárquico." id="toc-paso-2.1.-defina-el-método-de-agrupación-en-caso-de-cluster-jerárquico." class="nav-link" data-scroll-target="#paso-2.1.-defina-el-método-de-agrupación-en-caso-de-cluster-jerárquico."><span class="header-section-number">4.4.1</span> Paso 2.1. Defina el método de agrupación en caso de cluster Jerárquico.</a></li>
  </ul></li>
  <li><a href="#paso-3.-defina-el-número-óptimo-de-grupos-a-formar." id="toc-paso-3.-defina-el-número-óptimo-de-grupos-a-formar." class="nav-link" data-scroll-target="#paso-3.-defina-el-número-óptimo-de-grupos-a-formar."><span class="header-section-number">4.5</span> Paso 3. Defina el número óptimo de grupos a formar.</a></li>
  <li><a href="#paso-4.-ejecute-el-algoritmo-y-represente-y-describa-las-agrupaciones." id="toc-paso-4.-ejecute-el-algoritmo-y-represente-y-describa-las-agrupaciones." class="nav-link" data-scroll-target="#paso-4.-ejecute-el-algoritmo-y-represente-y-describa-las-agrupaciones."><span class="header-section-number">4.6</span> Paso 4. Ejecute el algoritmo, y represente y describa las agrupaciones.</a>
  <ul class="collapse">
  <li><a href="#no-jerárquico---kmeans." id="toc-no-jerárquico---kmeans." class="nav-link" data-scroll-target="#no-jerárquico---kmeans."><span class="header-section-number">4.6.1</span> No jerárquico - Kmeans.</a></li>
  <li><a href="#jerárquico." id="toc-jerárquico." class="nav-link" data-scroll-target="#jerárquico."><span class="header-section-number">4.6.2</span> Jerárquico.</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#práctica." id="toc-práctica." class="nav-link" data-scroll-target="#práctica."><span class="header-section-number">5</span> Práctica.</a></li>
  <li><a href="#material-complementario-para-profundizar." id="toc-material-complementario-para-profundizar." class="nav-link" data-scroll-target="#material-complementario-para-profundizar."><span class="header-section-number">6</span> Material complementario para profundizar.</a></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Análisis de clúster con RStudio</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Kenedith. M. Méndez Gutiérrez </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">October 23, 2024</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<style type="text/css">
  body{
  font-family: Georgia;
  font-size: 12pt;
  text-align: justify;
}
  h1 {
  color: #4C56AC;
  font-size: 20pt;
  font-family: Georgia;
  text-align: left;
  font-weight: blod;
}
  h2 {
  color: #8A4CAC;
  font-size:14pt;
  font-family: Georgia;
  text-align: left;
  font-weight: blod;
}
  h3{ 
  color: #black;
  font-size:13pt;
  font-family: Georgia;
  text-align: left;
  font-weight: blod;
}
</style>
<section id="introducción" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Introducción</h1>
<section id="qué-es" class="level3" data-number="1.0.1">
<h3 data-number="1.0.1" class="anchored" data-anchor-id="qué-es"><span class="header-section-number">1.0.1</span> ¿Qué es?</h3>
<p>El análisis clúster es un método estadístico multivariante de clasificación automática no supervisada a partir de una matriz de Observaciones-variables, en grupos homogéneos, conglomerados o clústeres, no conocidos de antemano pero sugeridos, en función de las distancias entre los puntos de datos, para obtener una mayor comprensión de los datos ó porcesarlos de manera más eficiente. (Fuente: <em>Shimodaira, H. (2020). Clustering and Visualisation of Data. Ed.ac.uk)</em></p>
<p>Hay dos enfoques principales para el agrupamiento: jerárquico y particional ó no Jerárquicos. El agrupamiento jerárquico forma un árbol de clústeres anidados en el que, en cada nivel del árbol, un clúster es la unión de sus hijos. El agrupamiento particional ó no Jerárquico no tiene una estructura anidada o jerárquica, simplemente divide el conjunto de datos en un número fijo de grupos que no se superponen, con cada punto de datos asignado a exactamente un grupo. El algoritmo de agrupamiento particional más empleado, el agrupamiento K-means.</p>
</section>
<section id="objetivos-del-análisis" class="level3" data-number="1.0.2">
<h3 data-number="1.0.2" class="anchored" data-anchor-id="objetivos-del-análisis"><span class="header-section-number">1.0.2</span> Objetivos del análisis</h3>
<ul>
<li>Modo Q. Agrupar elementos en grupos homogéneos en función de las similitudes o similaridades entre ellos.</li>
<li>Modo R. Dividir las variables en grupos para plantear modelos formales y reducir la dimensión.</li>
</ul>
</section>
<section id="consideraciones-para-aplicar-el-análisis-a-una-matriz-de-datos-básica." class="level3" data-number="1.0.3">
<h3 data-number="1.0.3" class="anchored" data-anchor-id="consideraciones-para-aplicar-el-análisis-a-una-matriz-de-datos-básica."><span class="header-section-number">1.0.3</span> Consideraciones para aplicar el análisis a una matriz de datos básica.</h3>
<p>Para poder aplicar el análisis de importante:</p>
<ol type="1">
<li>Verificar si el conjunto de datos no se encuentra correlacionado.</li>
<li>Escoger de una medida de distancia propiada.</li>
<li>Verificar la tendencia de agrupamiento del conjunto.</li>
</ol>
</section>
</section>
<section id="materiales." class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Materiales.</h1>
<ul>
<li><p>Matriz de datos básica de la Guía: <a href="https://campusvirtual.unimagdalena.edu.co/d2l/common/viewFile.d2lfile/Content/L2NvbnRlbnQvZW5mb3JjZWQvMTE0ODI1LTM4RC0yMDQzODAzLTEtMjAyNDEvVGVldGgueGxzeA/Teeth.xlsx?ou=114825">Teeth</a></p></li>
<li><p>Matriz de datos básica para la clase:</p>
<ul>
<li><p><strong><em>Ephemeroptera_In_R</em></strong>. Contiene la información sobre la abundancia de 11 especies del orden Ephemeroptera y 10 variables ambientales en 6 sitios de muestreo en dos estaciones sp (primavera), wi (invierno).</p></li>
<li><p><strong><em>Diatom:</em></strong> Contiene la información de la presencia/ausencia de diferentes especies de diatomeas de la familia Gomphonemataceae de plantas en 193 muestras de piedras recolectadas durante los meses de junio a septiembre de 1998 en diferentes ríos y arroyos franceses por parte del Cemagref y el Centre de Recherche Gabriel Lippman, los cuales posteriormente se analizaron los biofilm.</p></li>
<li><p><strong><em>Alpes_Sp_Rasgos:</em></strong> Las matrices en el archivo de Excel hacen parte del trabajo realizado por Choler en el 2005 y retomado por Dray et al en el 2014, donde el área de estudio comprendió 75 sitios de muestreo repartidos en dos hectáreas entre 2700 m y 2750 m de elevación sobre el suroeste de los Alpes europeo (Lieu ‐ dit Aravo, Commune de Valloire, Francia; 45.067 ° N, 6.394 ° E). La información que se presenta corresponde a 8 rasgos funcionales de la composición de plantas vasculares descrita por especie.</p></li>
</ul></li>
<li><p><a href="https://campusvirtual.unimagdalena.edu.co/d2l/common/viewFile.d2lfile/Content/L2NvbnRlbnQvZW5mb3JjZWQvMTc0MzUxLTM4RC0zLTAyMDQzODAzLTEtMjAyNDIvU2NyaXB0X3FtZENsLnFtZA/Script_qmdCl.qmd?ou=174351">ScriptCluster_qmd</a></p></li>
</ul>
</section>
<section id="cómo-abordar-el-análisis" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> ¿Cómo abordar el análisis?</h1>
<ol type="1">
<li>Verifica los requerimientos.</li>
<li>Defina el tipo de algoritmo.
<ol type="1">
<li>Defina el método de agrupación en caso de cluster Jerárquico.</li>
</ol></li>
<li>Defina el número óptimo de grupos a formar.</li>
<li>Ejecute el algoritmo y represente y describa las agrupaciones.</li>
</ol>
</section>
<section id="pasos-previos." class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Pasos previos.</h1>
<section id="cargue-las-líbrerías." class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="cargue-las-líbrerías."><span class="header-section-number">4.1</span> 1. Cargue las líbrerías.</h2>
<div class="cell" data-layout-align="center">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MVN)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cluster)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(factoextra)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vegan)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(amap)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(NbClust)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(clValid)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(flextable)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="importe-los-datos." class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="importe-los-datos."><span class="header-section-number">4.2</span> 2. Importe los datos.</h2>
<p>Para ejemplificar usaremos la base de datos <span style="color: #F84F00;">“Teeth”</span> que contiene la información del número total de dientes de 66 mamíferos tanto en la mandíbula superior como en la inferior para cuatro grupos de acuerdo con funciones especializadas en, incisivos, caninos, premolares y molares. Esta información es de utilidad para proporciona una simple base numérica de clasificación de los mamíferos rastreando los cambios evolutivos.</p>
<p><span style="align: center;"> <strong>Tabla 1.</strong></span></p>
<p><em>Descripción de las variables</em> </p>
<table class="table">
<thead>
<tr class="header">
<th>Variables</th>
<th>Unidad de medición</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>name</td>
<td>ID del mamífero.</td>
</tr>
<tr class="even">
<td>top.i</td>
<td>N° de dientes incisivos en la mandíbula superior.</td>
</tr>
<tr class="odd">
<td>bottom.i</td>
<td>N° de dientes incisivos en la mandíbula inferior.</td>
</tr>
<tr class="even">
<td>top.c</td>
<td>N° de dientes caninos en la mandíbula superior.</td>
</tr>
<tr class="odd">
<td>bottom.c</td>
<td>N° de dientes caninos en la mandíbula inferior.</td>
</tr>
<tr class="even">
<td>top.pm</td>
<td>N° de dientes premolares en la mandíbula superior.</td>
</tr>
<tr class="odd">
<td>bottom.pm</td>
<td>N° de dientes premolares en la mandíbula inferior.</td>
</tr>
<tr class="even">
<td>top.m</td>
<td>N° de dientes molares en la mandíbula superior.</td>
</tr>
<tr class="odd">
<td>bottom.m</td>
<td>N° de dientes molares en la mandíbula inferior.</td>
</tr>
</tbody>
</table>
<hr>
<p>Cargaremos los datos en el ambiente de RStudio y luego cambiemos la naturaleza del objeto usando la función <code>"as.data.frame()"</code>. Seguidamente le daremos etiquetas a las UE usando la función <code>"row.names()"</code> las cuales se ubican en la columna 1 de la matriz de datos básica bajo el nombre de <strong>name</strong>.</p>
<div class="cell" data-layout-align="center">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>Teeth <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="at">path =</span> <span class="st">"D://Unimagdalena cursos//2021/2021-I//EMV 2021-I Tutoriales//Técnicas MV//Dataset_Guías//Teeth.xlsx"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>A<span class="ot">&lt;-</span><span class="fu">data.frame</span>(Teeth[,<span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(A)<span class="ot">&lt;-</span>Teeth<span class="sc">$</span>name</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="paso-1.-verifica-los-requerimientos." class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="paso-1.-verifica-los-requerimientos."><span class="header-section-number">4.3</span> Paso 1. Verifica los requerimientos.</h2>
<section id="verificar-si-el-conjunto-de-datos-no-se-encuentra-correlacionado." class="level3" data-number="4.3.1">
<h3 data-number="4.3.1" class="anchored" data-anchor-id="verificar-si-el-conjunto-de-datos-no-se-encuentra-correlacionado."><span class="header-section-number">4.3.1</span> Verificar si el conjunto de datos no se encuentra correlacionado.</h3>
<p>Para verificar si el conjunto de datos no se encuentra correlacionado usamos el test de esfericidad de Bartlett.</p>
<p><strong>RECUERDE.</strong> Siempre que se análiza la matriz de correlación se verifica la normalidad multivariante porque para construirla se definir el coeficiente de correlación apropiado en el argumento <code>"method"</code></p>
<div class="cell" data-layout-align="center">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mvn</span>(<span class="at">data =</span> A,<span class="at">mvnTest =</span> <span class="st">"mardia"</span>)<span class="sc">$</span>multivariateNormality[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,]<span class="sc">%&gt;%</span> </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">format =</span> <span class="st">"html"</span>,</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">caption =</span> <span class="st">"Tabla 1. Verificación de la normalidad multivariante"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-classic table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Tabla 1. Verificación de la normalidad multivariante</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Statistic</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">p value</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Result</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Mardia Skewness</td>
<td style="text-align: left;">587.342337202646</td>
<td style="text-align: left;">1.04464124269658e-62</td>
<td style="text-align: left;">NO</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mardia Kurtosis</td>
<td style="text-align: left;">10.1289219102596</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">NO</td>
</tr>
</tbody>
</table>


</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cortest.bartlett</span>(<span class="at">R =</span> <span class="fu">cor</span>(A,<span class="at">method =</span> <span class="st">"kendall"</span>),<span class="at">n =</span> <span class="fu">nrow</span>(A))<span class="sc">%&gt;%</span> <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">kable</span>(<span class="at">format =</span> <span class="st">"html"</span>,</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">caption =</span> <span class="st">"Tabla 2. Verificación matriz correlada"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-classic table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Tabla 2. Verificación matriz correlada</caption>
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">chisq</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p.value</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">df</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">432.8554</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">28</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>No posible verificar que el conjunto de datos no se encuentra correlacionado ya que test de esfericidad de Bartlett reflejo que hay evidencia suficiente de correlaciones significativas entre más de dos pares de variables, <em>𝜒²(28)=432.85 , p&lt;0.05</em>. Por lo que hay que considerar un coeficiente que tenga en cuenta tales correlaciones o pasar los datos por un análisis de componenetes principales previamente.</p>
</section>
<section id="escoger-de-una-medida-de-distancia-propiada." class="level3" data-number="4.3.2">
<h3 data-number="4.3.2" class="anchored" data-anchor-id="escoger-de-una-medida-de-distancia-propiada."><span class="header-section-number">4.3.2</span> Escoger de una medida de distancia propiada.</h3>
<p>Usaremos la medida de distancia de <strong>Bray</strong> y útil para encontrar similitudes entre UE cuando el conjunto de variables son cuantitativas discretas de conteo, también se podría emplear la medida de distancia basada en correlaciones, en nuestro caso de <strong>Kendall</strong>.</p>
</section>
<section id="verificar-la-tendencia-de-agrupamiento-del-conjunto." class="level3" data-number="4.3.3">
<h3 data-number="4.3.3" class="anchored" data-anchor-id="verificar-la-tendencia-de-agrupamiento-del-conjunto."><span class="header-section-number">4.3.3</span> Verificar la tendencia de agrupamiento del conjunto.</h3>
<p>La evaluación de la tendencia de agrupacmiento se puede hacer con métodos numéricos usando el Estadístico de Hopkins - (<span class="math inline">\(H\)</span>) ó métodos visuales usando gráficos de mapa de calor ó el biplot de los UE.</p>
<p>El <strong>Estadístico Hopkins(Lawson y Jurs 1990)</strong>: Mide la fiabilidad en base a la probabilidad de que un conjunto de datos dado sea generado por una distribución de datos uniforme.En otras palabras, prueba la aleatoriedad espacial de los datos.</p>
<p><span class="math inline">\(H_0:\)</span> el conjunto de datos se distribuye uniformemente (es decir, no hay agrupaciones significativas).</p>
<p><span class="math inline">\(H_1:\)</span> el conjunto de datos no está distribuido uniformemente (es decir, hay agrupaciones significativas).</p>
<p>Para su interpretación se toma como umbral un valor de 0.5 no rechazando la hipótesis nula si la estadística de Hopkins (H) es menor 0.5; en tal caso es poco probable que la matriz tenga grupos estadísticamente significativos; de lo contrario si el valor de la estadística de Hopkins está cerca de 1, entonces podemos rechazar la hipótesis nula y concluir que el conjunto de datos es significativamente agrupable.</p>
<p>Calularemos el estadístico de Hopkins usando la función <code>"get_clust_tendency()"</code> indicando primero la matriz de datos, seguido de los grados del libertad (n-1).</p>
<div class="cell" data-layout-align="center">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">get_clust_tendency</span>(A,<span class="at">n =</span> <span class="fu">nrow</span>(A)<span class="sc">-</span><span class="dv">1</span>,<span class="at">graph =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$hopkins_stat
[1] 0.7565377

$plot
NULL</code></pre>
</div>
</div>
<p>Se puede ver que el conjunto de datos es altamente agrupable, (<span class="math inline">\(H =0.76 &gt; 0.5\)</span>).</p>
<p>Para la evaluación visual de la tendencia de agrupamiento se requiere primero calcular la matriz de disimilitud entre observaciones usando la función <code>"vegdist()"</code> y luego se gráfica con la función <code>"fviz_dist()"</code> El nivel de color es proporcional al valor de la diferencia entre las observaciones en rojo tienen alta similitud (es decir, baja disimilitud) y en azul tienen similitud baja. Objetos pertenecientes al mismo grupo se muestran en orden consecutivo.</p>
<div class="cell" data-layout-align="center">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>dist1 <span class="ot">&lt;-</span> <span class="fu">vegdist</span>(A, <span class="at">method =</span> <span class="st">"bray"</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_dist</span>(dist1,<span class="at">lab_size =</span> <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Cluster_RStudio_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="624"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="paso-2.-defina-el-tipo-de-algoritmo." class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="paso-2.-defina-el-tipo-de-algoritmo."><span class="header-section-number">4.4</span> Paso 2. Defina el tipo de algoritmo.</h2>
<p>Existen diferentes métodos de agrupación de datos, que incluyen enfoques de agrupamiento de particiones (no jerárquico) y enfoques de agrupamiento jerárquico. Elegir el mejor método de agrupación puede resultar una tarea difícil para el analista. La función <code>"clValid()"</code> se puede utilizar para comparar simultáneamente múltiples algoritmos de agrupación y así identificar el mejor enfoque de agrupación. La función emplea para la compración medidas de <strong>validación internas</strong>, que utilizan la información intrínseca en los datos para evaluar la calidad de la agrupación, y las <strong>medidas de estabilidad</strong> que evalúan la consistencia de un resultado de agrupación comparándolo con las agrupaciones obtenidas después de eliminar cada columna, una a la vez.</p>
<p><strong>Nota.</strong> En la práctica se suele emplear el algoritmo no jerárquico cuando se tienen muchos datos agrupar y el jerárquico cuando no.</p>
<div class="cell" data-layout-align="center">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>Vali<span class="ot">&lt;-</span><span class="fu">clValid</span>(A, <span class="at">nClust =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">6</span>,<span class="at">clMethods =</span><span class="fu">c</span>(<span class="st">"hierarchical"</span>,<span class="st">"kmeans"</span>), </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">validation =</span> <span class="fu">c</span>(<span class="st">"internal"</span>,<span class="st">"stability"</span>))</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">optimalScores</span>(Vali) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>Clusters) <span class="sc">%&gt;%</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kable</span>(<span class="at">format =</span> <span class="st">"html"</span>,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">caption =</span> <span class="st">"Tabla 3. Sugerencia de algoritmo"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-classic table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Tabla 3. Sugerencia de algoritmo</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Score</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Method</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">APN</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: left;">hierarchical</td>
</tr>
<tr class="even">
<td style="text-align: left;">AD</td>
<td style="text-align: right;">1.6722668</td>
<td style="text-align: left;">kmeans</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ADM</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: left;">hierarchical</td>
</tr>
<tr class="even">
<td style="text-align: left;">FOM</td>
<td style="text-align: right;">0.5698764</td>
<td style="text-align: left;">kmeans</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Connectivity</td>
<td style="text-align: right;">2.9289683</td>
<td style="text-align: left;">hierarchical</td>
</tr>
<tr class="even">
<td style="text-align: left;">Dunn</td>
<td style="text-align: right;">0.9013878</td>
<td style="text-align: left;">hierarchical</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Silhouette</td>
<td style="text-align: right;">0.6010916</td>
<td style="text-align: left;">hierarchical</td>
</tr>
</tbody>
</table>


</div>
</div>
<section id="paso-2.1.-defina-el-método-de-agrupación-en-caso-de-cluster-jerárquico." class="level3" data-number="4.4.1">
<h3 data-number="4.4.1" class="anchored" data-anchor-id="paso-2.1.-defina-el-método-de-agrupación-en-caso-de-cluster-jerárquico."><span class="header-section-number">4.4.1</span> Paso 2.1. Defina el método de agrupación en caso de cluster Jerárquico.</h3>
<p>Cuando trabajamos con métodos jerárquicos se puede escoger entre varios métodos de agrupación. Para determinar cual es el mejor método se valida la estructura que proporciona el método jerárquico de que se trate al analizar la correlación entre la matriz de distancias original y la denominada matriz cofenética del método en cuestión. Con este coeficiente cofenético se mide la similitud entre las distancias iniciales (obtenidas a partir de los datos originales) y las distancias finales con las cuales los individuos se han unido durante el desarrollo del método jerárquico (matriz cofenética). Valores de la correlación altos (cercanos o iguales a la unidad) indican que es válida la agrupación realizada. (Fuente: <a href="https://www.um.es/estadempresa/multivarianteR/CLUS/resumen_CLUS.html" class="uri">https://www.um.es/estadempresa/multivarianteR/CLUS/resumen_CLUS.html</a>)</p>
<div class="cell" data-layout-align="center">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>hc1 <span class="ot">&lt;-</span> <span class="fu">hclust</span>(dist1,<span class="at">method =</span> <span class="st">"ward.D"</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>hc2 <span class="ot">&lt;-</span> <span class="fu">hclust</span>(dist1,<span class="at">method =</span> <span class="st">"single"</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>hc3 <span class="ot">&lt;-</span> <span class="fu">hclust</span>(dist1,<span class="at">method =</span> <span class="st">"complete"</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>hc4 <span class="ot">&lt;-</span> <span class="fu">hclust</span>(dist1,<span class="at">method =</span> <span class="st">"average"</span>)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>hc5 <span class="ot">&lt;-</span> <span class="fu">hclust</span>(dist1,<span class="at">method =</span> <span class="st">"mcquitty"</span>)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>hc6 <span class="ot">&lt;-</span> <span class="fu">hclust</span>(dist1,<span class="at">method =</span> <span class="st">"median"</span>)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>hc7 <span class="ot">&lt;-</span> <span class="fu">hclust</span>(dist1,<span class="at">method =</span> <span class="st">"centroid"</span>)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>Methods<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">"ward.D"</span>,<span class="st">"single"</span>,<span class="st">"complete"</span>,<span class="st">"average"</span>,<span class="st">"mcquitty"</span>,<span class="st">"median"</span>,<span class="st">"centroid"</span>)</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>Cophenetic_Dist<span class="ot">=</span><span class="fu">c</span>(<span class="fu">cophenetic</span>(hc1),<span class="fu">cophenetic</span>(hc2),<span class="fu">cophenetic</span>(hc3),</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">cophenetic</span>(hc4),<span class="fu">cophenetic</span>(hc5),<span class="fu">cophenetic</span>(hc6),</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">cophenetic</span>(hc7))</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>corelacion<span class="ot">=</span><span class="fu">c</span>(<span class="fu">cor</span>(dist1,<span class="fu">cophenetic</span>(hc1)),</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>             <span class="fu">cor</span>(dist1,<span class="fu">cophenetic</span>(hc2)),</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>             <span class="fu">cor</span>(dist1,<span class="fu">cophenetic</span>(hc3)),</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>             <span class="fu">cor</span>(dist1,<span class="fu">cophenetic</span>(hc4)),</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>             <span class="fu">cor</span>(dist1,<span class="fu">cophenetic</span>(hc5)),</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>             <span class="fu">cor</span>(dist1,<span class="fu">cophenetic</span>(hc6)),</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>             <span class="fu">cor</span>(dist1,<span class="fu">cophenetic</span>(hc7)))</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">data.frame</span>(Methods,corelacion),</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">booktabs =</span> <span class="cn">TRUE</span>,</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">digits =</span> <span class="dv">4</span>,</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">align =</span> <span class="st">"c"</span>,</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Método de agrupación"</span>,</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"Correlación cofenética"</span>),</span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">"Tabla 4. Correlaciones cofenéticas por método de agrupación jerárquica"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">font_size =</span> <span class="dv">14</span>,<span class="at">full_width =</span> <span class="cn">TRUE</span>,</span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>                <span class="at">html_font =</span> <span class="st">"serif"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-classic table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Tabla 4. Correlaciones cofenéticas por método de agrupación jerárquica</caption>
<thead>
<tr class="header">
<th style="text-align: center;" data-quarto-table-cell-role="th">Método de agrupación</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Correlación cofenética</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">ward.D</td>
<td style="text-align: center;">0.7432</td>
</tr>
<tr class="even">
<td style="text-align: center;">single</td>
<td style="text-align: center;">0.6905</td>
</tr>
<tr class="odd">
<td style="text-align: center;">complete</td>
<td style="text-align: center;">0.7600</td>
</tr>
<tr class="even">
<td style="text-align: center;">average</td>
<td style="text-align: center;">0.8431</td>
</tr>
<tr class="odd">
<td style="text-align: center;">mcquitty</td>
<td style="text-align: center;">0.7794</td>
</tr>
<tr class="even">
<td style="text-align: center;">median</td>
<td style="text-align: center;">0.8094</td>
</tr>
<tr class="odd">
<td style="text-align: center;">centroid</td>
<td style="text-align: center;">0.8430</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>De acuerdo con la información anterior el mejor método de agrupamiento es average, (<span class="math inline">\(r = 0.8431\)</span>).</p>
</section>
</section>
<section id="paso-3.-defina-el-número-óptimo-de-grupos-a-formar." class="level2" data-number="4.5">
<h2 data-number="4.5" class="anchored" data-anchor-id="paso-3.-defina-el-número-óptimo-de-grupos-a-formar."><span class="header-section-number">4.5</span> Paso 3. Defina el número óptimo de grupos a formar.</h2>
<p>Existen más de treinta índices y métodos que se han publicado para identificar el número óptimo de conglomerados, para hacer uso de ellos emplearemos la función <code>"NbClust()"</code> con el fin de decidir el mejor número de grupos utilizando la “regla de la mayoría”. Tambien se puede emplear un solo indice siendo el más usado en la práctica la amplitud de silueta, dónde el número óptimo de grupos a formar es aquel que máximice el valor del índice.</p>
<div class="cell" data-layout-align="center">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Para Kmeans - no Jerárquico Todos los índices.</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>res.nbclust<span class="ot">&lt;-</span><span class="fu">NbClust</span>(A, <span class="at">diss =</span> dist1,<span class="at">distance =</span> <span class="cn">NULL</span>,</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">min.nc =</span> <span class="dv">2</span>, <span class="at">max.nc =</span> <span class="dv">10</span>, </span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">method =</span> <span class="st">"kmeans"</span>,<span class="at">index =</span> <span class="st">"all"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Cluster_RStudio_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="624"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>*** : The Hubert index is a graphical method of determining the number of clusters.
                In the plot of Hubert index, we seek a significant knee that corresponds to a 
                significant increase of the value of the measure i.e the significant peak in Hubert
                index second differences plot. 
 </code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Cluster_RStudio_files/figure-html/unnamed-chunk-8-2.png" class="img-fluid figure-img" width="624"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>*** : The D index is a graphical method of determining the number of clusters. 
                In the plot of D index, we seek a significant knee (the significant peak in Dindex
                second differences plot) that corresponds to a significant increase of the value of
                the measure. 
 
******************************************************************* 
* Among all indices:                                                
* 6 proposed 2 as the best number of clusters 
* 7 proposed 3 as the best number of clusters 
* 4 proposed 4 as the best number of clusters 
* 1 proposed 8 as the best number of clusters 
* 4 proposed 9 as the best number of clusters 
* 2 proposed 10 as the best number of clusters 

                   ***** Conclusion *****                            
 
* According to the majority rule, the best number of clusters is  3 
 
 
******************************************************************* </code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="fu">t</span>(res.nbclust<span class="sc">$</span>Best.nc)),<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>Number_clusters))<span class="sc">+</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">boundary=</span><span class="dv">1</span>,<span class="at">fill=</span><span class="st">"skyblue"</span>,<span class="at">color=</span><span class="st">"skyblue3"</span>)<span class="sc">+</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">n.breaks =</span> <span class="dv">10</span>)<span class="sc">+</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()<span class="sc">+</span><span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Number of cluster"</span>, <span class="at">y=</span><span class="st">"Frequency"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Cluster_RStudio_files/figure-html/unnamed-chunk-8-3.png" class="img-fluid figure-img" width="624"></p>
</figure>
</div>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Para Kmeans - no Jerárquico amplitud de silueta.</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>n1<span class="ot">&lt;-</span><span class="fu">NbClust</span>(A, <span class="at">diss =</span> dist1,<span class="at">distance =</span> <span class="cn">NULL</span>,</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">min.nc =</span> <span class="dv">2</span>, <span class="at">max.nc =</span> <span class="dv">10</span>, </span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">method =</span> <span class="st">"kmeans"</span>,<span class="at">index =</span> <span class="st">"silhouette"</span>)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">K=</span><span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">10</span>),<span class="at">Value=</span>n1<span class="sc">$</span>All.index),<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>K,<span class="at">y=</span>Value))<span class="sc">+</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">boundary=</span><span class="dv">1</span>,<span class="at">lwd=</span><span class="dv">1</span>,<span class="at">color=</span><span class="st">"skyblue3"</span>)<span class="sc">+</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">pch=</span><span class="dv">21</span>,<span class="at">size=</span><span class="dv">3</span>,<span class="at">fill=</span><span class="st">"skyblue"</span>)<span class="sc">+</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">n.breaks =</span> <span class="dv">10</span>)<span class="sc">+</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()<span class="sc">+</span><span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Number of cluster"</span>, <span class="at">y=</span><span class="st">"Value index"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Cluster_RStudio_files/figure-html/unnamed-chunk-8-4.png" class="img-fluid figure-img" width="624"></p>
</figure>
</div>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Para Jerárquicos , amplitud de silueta.</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>n2<span class="ot">&lt;-</span><span class="fu">NbClust</span>(A, <span class="at">diss =</span> dist1,<span class="at">distance =</span> <span class="cn">NULL</span>,</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">min.nc =</span> <span class="dv">2</span>, <span class="at">max.nc =</span> <span class="dv">10</span>, </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">method =</span> <span class="st">"average"</span>,<span class="at">index =</span> <span class="st">"silhouette"</span>)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">K=</span><span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">10</span>),<span class="at">Value=</span>n2<span class="sc">$</span>All.index),<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>K,<span class="at">y=</span>Value))<span class="sc">+</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">boundary=</span><span class="dv">1</span>,<span class="at">lwd=</span><span class="dv">1</span>,<span class="at">color=</span><span class="st">"skyblue3"</span>)<span class="sc">+</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">pch=</span><span class="dv">21</span>,<span class="at">size=</span><span class="dv">3</span>,<span class="at">fill=</span><span class="st">"skyblue"</span>)<span class="sc">+</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">n.breaks =</span> <span class="dv">10</span>)<span class="sc">+</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()<span class="sc">+</span><span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Number of cluster"</span>, <span class="at">y=</span><span class="st">"Value index"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Cluster_RStudio_files/figure-html/unnamed-chunk-8-5.png" class="img-fluid figure-img" width="624"></p>
</figure>
</div>
</div>
</div>
<p>Para el algoritmo kmeans el número de grupos a formar sugeridos es 3 bajo el criterio de la mayoria. Para el algoritmo jerárquico de average el número de grupos a formar sugeridos es 8.</p>
</section>
<section id="paso-4.-ejecute-el-algoritmo-y-represente-y-describa-las-agrupaciones." class="level2" data-number="4.6">
<h2 data-number="4.6" class="anchored" data-anchor-id="paso-4.-ejecute-el-algoritmo-y-represente-y-describa-las-agrupaciones."><span class="header-section-number">4.6</span> Paso 4. Ejecute el algoritmo, y represente y describa las agrupaciones.</h2>
<p>Para ejecutar el algoritmo de kmeans y representarlo se usa la función <code>"eclust()"</code> que permite ejecutar el algoritmo de forma directa, donde el argumento <code>"FUNcluster"</code> se emplea para indicar si el método no jerárquico (<strong>“kmeans”, “pam”, “clara”</strong>) y la función <code>"hclust()"</code> para para ejecutar el algoritmo jerárquico a partir de la matriz de distancia (Como se uso en paso anterior). La función <code>"fviz_dend()"</code> muestra el dendograma para agrupaciones jerárquicas y la función <code>"fviz_cluster()"</code> muestra las garupaciones no jerárquicas en un plano de dimensiones reducidas.La función <code>"fviz_silhouette()"</code> evalua si las observaciones quedaron bien clasificadas (con valores positivos).</p>
<section id="no-jerárquico---kmeans." class="level3" data-number="4.6.1">
<h3 data-number="4.6.1" class="anchored" data-anchor-id="no-jerárquico---kmeans."><span class="header-section-number">4.6.1</span> No jerárquico - Kmeans.</h3>
<div class="cell" data-layout-align="center">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Algoritmo</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>Cl1 <span class="ot">&lt;-</span> <span class="fu">eclust</span>(<span class="at">x =</span> A,<span class="at">FUNcluster =</span> <span class="st">"kmeans"</span>,<span class="at">k =</span> <span class="dv">3</span>,<span class="at">graph =</span> <span class="cn">FALSE</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Figuras</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_cluster</span>(Cl1,<span class="at">repel =</span> <span class="cn">TRUE</span>,<span class="at">labelsize =</span> <span class="dv">7</span>, <span class="at">ellipse.type =</span> <span class="st">"t"</span>)<span class="sc">+</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()<span class="sc">+</span><span class="fu">labs</span>(<span class="at">title =</span> <span class="st">""</span>)<span class="sc">+</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Cluster_RStudio_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="624"></p>
</figure>
</div>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_silhouette</span>(Cl1)<span class="sc">+</span><span class="fu">theme_classic</span>()<span class="sc">+</span><span class="fu">coord_flip</span>()<span class="sc">+</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">6</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  cluster size ave.sil.width
1       1   20          0.56
2       2   28          0.40
3       3   18          0.47</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Cluster_RStudio_files/figure-html/unnamed-chunk-9-2.png" class="img-fluid figure-img" width="624"></p>
</figure>
</div>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Descripción</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>Cl1<span class="sc">$</span>centers <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">format =</span> <span class="st">"html"</span>,<span class="at">digits =</span> <span class="dv">3</span>,</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">caption =</span> <span class="st">"Tabla 5. Descripción por grupo"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-classic table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Tabla 5. Descripción por grupo</caption>
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">top.i</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">bottom.i</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">top.c</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">bottom.c</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">top.pm</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">bottom.pm</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">top.m</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">bottom.m</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1.050</td>
<td style="text-align: right;">0.950</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">1.150</td>
<td style="text-align: right;">0.800</td>
<td style="text-align: right;">3.250</td>
<td style="text-align: right;">3.250</td>
</tr>
<tr class="even">
<td style="text-align: right;">2.964</td>
<td style="text-align: right;">2.679</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.964</td>
<td style="text-align: right;">3.500</td>
<td style="text-align: right;">3.321</td>
<td style="text-align: right;">1.536</td>
<td style="text-align: right;">1.964</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.833</td>
<td style="text-align: right;">3.500</td>
<td style="text-align: right;">0.611</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">2.667</td>
<td style="text-align: right;">2.833</td>
<td style="text-align: right;">3.000</td>
<td style="text-align: right;">3.000</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="jerárquico." class="level3" data-number="4.6.2">
<h3 data-number="4.6.2" class="anchored" data-anchor-id="jerárquico."><span class="header-section-number">4.6.2</span> Jerárquico.</h3>
<div class="cell" data-layout-align="center">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Figuras</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_dend</span>(hc4,<span class="at">k =</span> <span class="dv">8</span>,<span class="at">k_colors =</span> <span class="st">"jco"</span>,<span class="at">type =</span> <span class="st">"rectangle"</span>,<span class="at">cex =</span> <span class="fl">0.3</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Cluster_RStudio_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="624"></p>
</figure>
</div>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Descripción</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>grupo<span class="ot">&lt;-</span><span class="fu">cutree</span>(hc4,<span class="at">k=</span><span class="dv">8</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>sil <span class="ot">&lt;-</span> <span class="fu">silhouette</span>(grupo, dist1)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(sil)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fu">row.names</span>(A))</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_silhouette</span>(sil)<span class="sc">+</span><span class="fu">theme_classic</span>()<span class="sc">+</span><span class="fu">coord_flip</span>()<span class="sc">+</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">6</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  cluster size ave.sil.width
1       1    1          0.00
2       2   26          0.44
3       3    9          0.60
4       4    1          0.00
5       5   14          0.63
6       6    5          1.00
7       7    1          0.00
8       8    9          0.93</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Cluster_RStudio_files/figure-html/unnamed-chunk-10-2.png" class="img-fluid figure-img" width="624"></p>
</figure>
</div>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>B<span class="ot">&lt;-</span><span class="fu">data.frame</span>(A,<span class="at">grupo=</span><span class="fu">as.factor</span>(grupo))</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>B <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(grupo) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">top.i=</span><span class="fu">mean</span>(top.i),</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">bottom.i=</span><span class="fu">mean</span>(bottom.i),</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">top.c=</span><span class="fu">mean</span>(top.c),</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">bottom.c=</span><span class="fu">mean</span>(bottom.c),</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">top.pm=</span><span class="fu">mean</span>(top.pm),</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">bottom.pm=</span><span class="fu">mean</span>(bottom.pm),</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">top.m=</span><span class="fu">mean</span>(top.m),</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">bottom.m=</span><span class="fu">mean</span>(bottom.m)) <span class="sc">%&gt;%</span> </span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>   <span class="fu">kable</span>(<span class="at">format =</span> <span class="st">"html"</span>,<span class="at">digits =</span> <span class="dv">3</span>,</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">caption =</span> <span class="st">"Tabla 5. Descripción por grupo"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-classic table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Tabla 5. Descripción por grupo</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">grupo</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">top.i</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">bottom.i</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">top.c</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">bottom.c</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">top.pm</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">bottom.pm</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">top.m</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">bottom.m</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: right;">5.000</td>
<td style="text-align: right;">4.000</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">3.000</td>
<td style="text-align: right;">3.000</td>
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">4.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: right;">2.885</td>
<td style="text-align: right;">2.769</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">3.577</td>
<td style="text-align: right;">3.385</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: right;">1.962</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: right;">1.889</td>
<td style="text-align: right;">2.889</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.889</td>
<td style="text-align: right;">2.222</td>
<td style="text-align: right;">2.556</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">3.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">4</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">8.0</td>
<td style="text-align: right;">8.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">5</td>
<td style="text-align: right;">1.143</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">1.643</td>
<td style="text-align: right;">1.143</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">3.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">6</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">3.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">7</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">3.000</td>
<td style="text-align: right;">3.000</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">8</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">4.000</td>
<td style="text-align: right;">0.222</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">3.000</td>
<td style="text-align: right;">3.000</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">3.000</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
</section>
</section>
<section id="práctica." class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Práctica.</h1>
<p>Replique a manera de práctica el análisis de clúster usando la matriz de datos básica <span style="color: #F84F00;"><a href="https://campusvirtual.unimagdalena.edu.co/d2l/common/viewFile.d2lfile/Content/L2NvbnRlbnQvZW5mb3JjZWQvMTE0ODI1LTM4RC0yMDQzODAzLTEtMjAyNDEvTWlsa3MueGxzeA/Milks.xlsx?ou=114825">“Milks”</a></span> que contiene información de la composición de la leche en términos de porcentaje de agua, proteínas, grasas y lactosa de 16 mamíferos.</p>
<p>A partir del análisis responda a:</p>
<ol type="1">
<li>¿qué requerimientos se pudieron verificar?</li>
<li>¿es posible encontrar grupos homogéneo internamente entre las UE de la matriz? ¿usando que medida de distancia?</li>
<li>¿qué algoritmo de agrupación es el apropiado para el conjunto?</li>
<li>¿cuál es el número óptimo de clúster?</li>
<li>¿qué característica tienen en común las UE de cada grupo?¿alguna UE se encuentra mal clasificada?.</li>
</ol>
</section>
<section id="material-complementario-para-profundizar." class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Material complementario para profundizar.</h1>
<ol type="1">
<li><p>Borcard, Daniel. G. (2018). Cluster Analysis. En N. Springer New York, François. Gillet, &amp; Pierre. Legendre (Eds.), Numerical Ecology with R [electronic resource] (2nd ed.&nbsp;2018., pp.&nbsp;59-150). Springer International (Link: <a href="https://unimagdalena.alma.exlibrisgroup.com/leganto/public/57UMA_INST/citation/3629658090007076?auth=LDAP" class="uri">https://unimagdalena.alma.exlibrisgroup.com/leganto/public/57UMA_INST/citation/3629658090007076?auth=LDAP</a>)</p></li>
<li><p>Legendre, P., &amp; Legendre, Louis. (2018). Cluster analysis. En Elsevier Science B. V., François. Gillet, &amp; Pierre. Legendre (Eds.), Numerical Ecology (3rd ed.&nbsp;2012, pp.&nbsp;320-383). Springer International Publishing (Link: <a href="https://unimagdalena.alma.exlibrisgroup.com/leganto/public/57UMA_INST/citation/3629655550007076?auth=LDAP" class="uri">https://unimagdalena.alma.exlibrisgroup.com/leganto/public/57UMA_INST/citation/3629655550007076?auth=LDAP</a>)</p></li>
<li><p>Alboukadel Kassambara. (s. f.). Determining The Optimal Number Of Clusters: 3 Must Know Methods - Datanovia. DATANOVIA.(Link: <a href="https://unimagdalena.alma.exlibrisgroup.com/leganto/public/57UMA_INST/citation/3629656390007076?auth=LDAP" class="uri">https://unimagdalena.alma.exlibrisgroup.com/leganto/public/57UMA_INST/citation/3629656390007076?auth=LDAP</a>)</p></li>
<li><p>Alboukadel Kassambara. (s. f.). Cluster Validation Statistics: Must Know Methods - Datanovia. DATANOVIA. (Link: <a href="https://unimagdalena.alma.exlibrisgroup.com/leganto/public/57UMA_INST/citation/3629656500007076?auth=LDAP" class="uri">https://unimagdalena.alma.exlibrisgroup.com/leganto/public/57UMA_INST/citation/3629656500007076?auth=LDAP</a>)</p></li>
</ol>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>